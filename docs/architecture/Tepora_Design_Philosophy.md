# Tepora - Design Philosophy

## 1. Purpose / Context
Teporaは「コンシューマーハードウェアで動作する、真のパーソナルAIエージェントの実用化」を目指すプロジェクトである。
（※プロジェクトの核心的なビジョンについては [Tepora_Project_Vision.md](./Tepora_Project_Vision.md) を参照）

本ドキュメントは、そのビジョンを実現する過程で、日々直面する無数の技術的判断において従うべき「羅針盤（哲学・原則）」を定義する。
具体的なコーディング規約やツール選定よりも上位の、「なぜその選択をするのか」という価値観をここに記す。

## 2. Core Principles（最優先の判断基準）
### P1. Local First / Privacy First
- **データ主権の尊重:** 可能な限り処理・データはローカル完結させる。
- **透明性:** 外部送信が発生する（Web検索など）場合は、必ずユーザーに分かる形で明示し、その範囲を最小化する。

### P2. Production Ready（実験より運用品質）
- **堅牢性 (Robustness):** 例外を握り潰さず、エラー発生時でもシステム全体が崩壊しないよう、適切な復旧導線と失敗時UXを設計する。
- **静的安全性 (Static Safety):** "実行して初めて気づくエラー" を極限まで減らす。動的な柔軟性よりも、型システムと静的解析による厳格な整合性チェックを優先する。
- **保守性 (Maintainability):** “動く”ことよりも “理解でき、直せる” ことを重視する。コードの可読性とテスト容易性は、機能追加の速度よりも優先される。

### P3. Hardware Agnostic
- **民主化された動作:** ハイエンドGPUを前提とせず、CPUのみや小規模モデル（Quantized）でも許容可能な体験を提供する。
- **並行性の重視:** リソース制限下でもUIがフリーズしないよう、重い処理は非同期かつ段階的に実行する (Graceful Degradation)。

### P4. Modular & Hierarchical Design（モジュール性と階層性）
- **疎結合:** LLM / Memory / Tools / UI を独立したモジュールとして扱い、特定の技術・モデルにロックインされない設計とする。
- **専門化と協調:** 全知全能の単一モデルに頼るのではなく、計画・実行・監督といった「役割」を分離し、専門化されたエージェントが協調するアーキテクチャを採用する。
- **標準への準拠:** 独自規格による囲い込みを避け、標準プロトコル（MCP等）を採用することで、外部エコシステムとの相互運用性を維持する。

### P5. Warm & Calm UX（紅茶・喫茶店コンセプト）
- **精神的安全性:** 早さや効率だけでなく、安心感・分かりやすさ・落ち着きを優先する。
- **正直なAI (Honest AI):** 不確実なことは「分からない」と正直に伝える。
- **思考の可視化 (Visible Thinking):** AIの判断プロセスをブラックボックス化せず、思考過程をユーザーに提示することで、共に考えるパートナーとしての「納得感」を醸成する。

## 3. Non-goals（やらないこと）
- **万能の追求:** 特化型ツールの集合体を目指し、“1つのプロンプトですべて解決する魔法”は目指さない。
- **クラウド依存:** クラウド前提の常時接続設計はしない（インターネットはあくまで「拡張機能」）。
- **ブラックボックスな自動化:** ユーザーが制御できない勝手な自動化より、プロセスの見える「主導権のある」自動化を優先する。

## 4. Design Constraints（設計上の縛り）
- **セキュリティ:** ローカルデータの扱い、権限、秘密情報の露出を最優先で防ぐ。
- **データ:** 永続化データは将来的な構造変更（マイグレーション）を常に想定する。
- **失敗の常態化:** ネットワーク切断、モデルの幻覚、ツール実行エラーは“異常”ではなく“日常”として扱う。

## 5. Architectural Invariants（破ってはいけないルール）
- **Stateless Core:** コアロジックはステートレスに設計し、スケーラビリティと並行実行性を担保する。
- **UI/Logic分離:** UIコンポーネントにビジネスロジックを混入させない。
- **監査可能性 (Auditability):** AIの自律的な行動はすべてログとして記録し、ユーザーが「何を・いつ・なぜ実行したか」を後から追跡可能にする。
- **コンテキストの純粋性:** Memoryへ投入する情報は厳選し、不正確なデータでコンテキスト汚染を起こさない仕組みを持つ。

## 6. Trade-offs（迷ったときの優先順位）
原則： **Privacy/Safety (守秘・安全) > Reliability (確実さ) > UX (心地よさ) > Performance (速さ) > Fancy features (新機能)**

## 7. Definition of Done（完了条件の指針）
機能実装完了とは、単にコードが動くことではなく、以下の品質基準を満たすことを指す：
- **追跡可能性:** 主要な失敗ケースがログやステータスで追えること。
- **検証可能性:** 重要ロジックに対するテストが存在する、あるいは検証手順が確立されていること。
- **型安全性:** 型システムによるチェックを通過し、型レベルでの整合性が取れていること。
- **記録:** アーキテクチャに影響する変更には、ADR (Architecture Decision Record) 等で意思決定の背景を残すこと。
